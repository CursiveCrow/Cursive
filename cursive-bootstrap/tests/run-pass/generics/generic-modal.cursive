// RUN: run-pass
// EXIT: 42
// SPEC: 5.4
// DESC: Generic modal type

modal Option<T> {
    state Some { value: T }
    state None { }
}

procedure unwrap_or<T>(opt: Option<T>, default: T) -> T {
    return match opt {
        Option::Some{ value } => { value }
        Option::None{} => { default }
    }
}

public procedure main(move ctx: Context) -> i32 {
    let some: Option<i32>@Some = Option<i32>@Some{ value: 42 }
    return unwrap_or(widen some, 0)
}
