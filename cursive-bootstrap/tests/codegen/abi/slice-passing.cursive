// RUN: run-pass
// EXIT: 10
// SPEC: 6.2 ABI-Slice
// DESC: Verify fat pointer (ptr + len) passing for slices

procedure sum_slice(s: const [i32]) -> i32 {
    var total: i32 = 0
    var i: usize = 0
    loop i < s~>len() {
        total = total + s[i]
        i = i + 1
    }
    return total
}

procedure slice_len(s: const [i32]) -> usize {
    return s~>len()
}

public procedure main(move ctx: Context) -> i32 {
    let arr: [i32; 4] = [1, 2, 3, 4]
    let s: const [i32] = arr[0..4]

    let len: usize = slice_len(s)
    let sum: i32 = sum_slice(s)

    return if len == 4 { sum } else { 1 }
}
