// RUN: run-pass
// EXIT: 42
// SPEC: 6.2 ABI-Enum
// DESC: Verify enum passing conventions

enum Option {
    None
    Some(i32)
}

enum Color {
    Red
    Green
    Blue
}

procedure unwrap_option(opt: Option) -> i32 {
    return match opt {
        Option::None => { 0 }
        Option::Some(v;) => { v }
    }
}

procedure color_code(c: Color) -> i32 {
    return match c {
        Color::Red => { 1 }
        Color::Green => { 2 }
        Color::Blue => { 3 }
    }
}

public procedure main(move ctx: Context) -> i32 {
    let some: Option = Option::Some(42)
    let none: Option = Option::None

    let v1: i32 = unwrap_option(some)
    let v2: i32 = unwrap_option(none)

    let green: Color = Color::Green
    let code: i32 = color_code(green)

    return if v2 == 0 && code == 2 { v1 } else { 1 }
}
