# SPEC_COV: Parallel-Multi-Panic
# SPEC_COV: ยง18.7.2
// Tests multiple panic handling (ยง18.7.2)
// When multiple work items panic:
// 1. Each panic is captured independently
// 2. All work completes or is cancelled
// 3. The first panic (by completion order) is raised
// 4. Other panics are discarded

public procedure main(ctx: Context) -> i32 {
  let domain = ctx~>inline()  // Use inline for deterministic ordering

  parallel domain {
    spawn {
      cursive::runtime::panic(1u32)
    }

    spawn {
      cursive::runtime::panic(2u32)  // This is discarded
    }

    spawn {
      cursive::runtime::panic(3u32)  // This is discarded
    }
  }

  // Should not reach here
  return 0i32
}
