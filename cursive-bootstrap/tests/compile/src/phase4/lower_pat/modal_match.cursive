# SPEC_COV: Lower-Expr-Match
# SPEC_COV: Match-Modal-General
# SPEC_COV: Match-Modal-Record
# SPEC_COV: Match-Modal-Empty
# SPEC_COV: Match-Modal-State

modal Status {
  @Idle {}
  @Busy { code: i32 }
}

public procedure main(ctx: Context) -> i32 {
  let s: Status = widen Status@Busy { code: 5 };
  let b = Status@Busy { code: 7 };
  let _ = match move s {
    @Idle => 0,
    @Busy { code } => code
  };
  return match move b {
    @Busy { code } => code
  };
}
