# SPEC_COV: C0X-Nested-GPU-Restriction
# SPEC_COV: ยง18.8.2
// Tests GPU parallel blocks cannot be nested (ยง18.8.2)
// GPU parallel blocks MUST NOT be nested inside other GPU parallel blocks
// Expected diagnostic: E-CON-0153

public procedure main(ctx: Context) -> i32 {
  let gpu = ctx~>gpu()
  parallel gpu {
    dispatch i in 0..100 {
      // Error: nested GPU parallel block
      let inner_gpu = ctx~>gpu()
      parallel inner_gpu {
        dispatch j in 0..10 {
        }
      }
    }
  }
  return 0
}
