# SPEC_COV: C0X-Dispatch-Key-Clause
# SPEC_COV: E-CON-0143
// Tests that key clause must be well-formed (ยง18.5.1)
// Expected diagnostic: E-CON-0143

record Data { values: [i32; 100] }

public procedure main(ctx: Context) -> i32 {
  let domain: $ExecutionDomain = ctx~>cpu()
  var data: shared Data = Data { values: [0; 100] }
  parallel domain {
    // Error: key clause references non-existent binding
    dispatch i in 0..100 key nonexistent write {
      data.values[i] = i
    }
  }
  return 0
}
