# SPEC_COV: C0X-Key-EscapeScope
# SPEC_COV: E-CON-0004
// Tests that key cannot escape its defining scope.
// Expected diagnostic: E-CON-0004

record Data { value: i32 }

procedure capture_key(d: shared Data) -> procedure () -> i32 {
  # d {
    // Error: key cannot escape via closure
    return procedure () -> i32 { return d.value }
  }
}

public procedure main(ctx: Context) -> i32 {
  return 0
}
