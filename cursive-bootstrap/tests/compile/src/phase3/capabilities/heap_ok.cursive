# SPEC_COV: T-Dynamic-MethodCall
procedure use_heap(move heap: unique $HeapAllocator) -> () {
  let quota: usize = 1024;
  let count: usize = 1;
  let _child: $HeapAllocator = heap~>with_quota(quota);

  unsafe {
    let p: *mut i32 = heap~>alloc_raw(count);
    heap~>dealloc_raw(p, count);
  };
  ()
}

public procedure main(ctx: Context) -> i32 {
  let raw: *imm i32 = null;
  use_heap(move unsafe {
    transmute::<(*imm i32, *imm i32), unique $HeapAllocator>((raw, raw))
  });
  return 0;
}
