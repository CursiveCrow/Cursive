// RUN: compile-fail
// DIAG: E-TYP-2052
// SPEC: 8.15
// DESC: Field access for field not present in current state's payload

modal Resource {
    state Empty {}
    state Ready { value: i32 }
}

procedure access_missing(r: Resource@Empty) -> i32 {
    return r.value  //~ ERROR E-TYP-2052: field not in state payload
}

public procedure main(move ctx: Context) -> i32 {
    return 0
}
