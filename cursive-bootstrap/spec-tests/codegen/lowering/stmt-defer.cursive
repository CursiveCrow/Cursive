// RUN: run-pass
// EXIT: 21
// SPEC: 6.5 Lower-Stmt-Defer
// DESC: Verify defer registration and execution lowering

procedure with_defer() -> i32 {
    var result: i32 = 10
    defer {
        result = result + 1
    }
    result = result * 2
    return result
}

public procedure main(move ctx: Context) -> i32 {
    return with_defer()
}
