// RUN: run-pass
// EXIT: 30
// SPEC: 6.4 Lower-Expr-FieldAccess
// DESC: Verify field access GEP generation

record Point {
    x: i32
    y: i32
}

record Nested {
    point: Point
    value: i32
}

public procedure main(move ctx: Context) -> i32 {
    let p: Point = Point { x: 10, y: 20 }
    let n: Nested = Nested { point: Point { x: 5, y: 15 }, value: 100 }

    let sum: i32 = p.x + p.y
    let nested_sum: i32 = n.point.x + n.point.y

    return if nested_sum == 20 { sum } else { 1 }
}
