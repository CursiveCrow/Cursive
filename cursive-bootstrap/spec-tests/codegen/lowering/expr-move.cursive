// RUN: run-pass
// EXIT: 42
// SPEC: 6.4 Lower-Expr-Move
// DESC: Verify move semantics lowering

record Data {
    value: i32
}

procedure consume(move d: Data) -> i32 {
    return d.value
}

procedure chain(move d: Data) -> i32 {
    return consume(move d)
}

public procedure main(move ctx: Context) -> i32 {
    let d1: Data = Data { value: 42 }
    let v1: i32 = consume(move d1)

    let d2: Data = Data { value: 100 }
    let v2: i32 = chain(move d2)

    return if v2 == 100 { v1 } else { 1 }
}
