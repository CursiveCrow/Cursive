// RUN: compile-fail
// DIAG: E-TYP-2308
// SPEC: 5.2.11
// DESC: Monomorphization depth limit exceeded

record Wrap<T> {
    inner: T
}

procedure deep<T>(x: T) -> Wrap<T> {
    return Wrap<T>{ inner: x }
}

procedure recurse<T>(x: T, n: i32) -> i32 {
    if n <= 0 {
        return 0
    }
    return recurse(deep(x), n - 1) //~ ERROR E-TYP-2308
}

public procedure main(move ctx: Context) -> i32 {
    return recurse(0, 1000)
}
