// RUN: compile-pass
// DIAG: W-CON-0140
// SPEC: 14.4
// DESC: Dynamic key pattern; runtime serialization

public procedure main(move ctx: Context) -> i32 {
    var arr: shared [i32; 10] = [0; 10]
    var i: i32 = 0
    loop i < 5 {
        let idx: usize = (i * 2) as usize
        dispatch arr[idx] write { //~ WARN W-CON-0140: runtime serialization
            arr[idx] = i
        }
        i = i + 1
    }
    return 0
}
