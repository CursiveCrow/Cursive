// RUN: compile-pass
// DIAG: W-CON-0004
// SPEC: 14.2
// DESC: Read-then-write may cause contention if parallelized

public procedure main(move ctx: Context) -> i32 {
    var arr: shared [i32; 10] = [0; 10]
    var i: i32 = 0
    loop i < 10 {
        #arr[i as usize] write {
            let val = arr[i as usize]
            arr[i as usize] = val + 1 //~ WARNING W-CON-0004
        }
        i = i + 1
    }
    return 0
}
